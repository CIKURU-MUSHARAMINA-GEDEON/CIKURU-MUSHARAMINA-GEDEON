#include <stdio.h>



// Modifie les details de l'utilisateur et les enregistre
void modifierutilisateur(){
    system("cls");
    fflush(stdin);

    char fname[255], lname[255], gender[5];
    char fname1[255], lname1[255], gender1[5];
    double sid, sid1, phone, phone1;

    int compare, flag=0;

    char find[255];
    printf("Entrer le nom de la personne que tu veux modifier ainsi que certains details: ");
    gets(find);

    fflush(stdin);

    FILE *pF = fopen("user_Records.txt", "r");
    FILE *pT = fopen("temporary.txt", "a");

    while(fscanf(pF, "%s %s %s %lf %lf \n", fname, lname, gender, &sid, &phone) != EOF)
    {
        compare = strcmp(find, fname);
        if(compare == 0)
        {
            printf("\n---------------------------------------------\n");
            printf(">>> Enregistrement trouve, autorisant les modifications<<<\n");
            printf("-----------------------------------------------\n\n");

            printf("> Entrer ton nom: ");
            gets(fname1);

            printf("> Entrez votre prenom: ");
            gets(lname1);

            printf("> Entrez votre sexe: ");
            gets(gender1);

            printf("> Entrez le ID OU le matricule: ");
            scanf("%lf",&sid1);

            printf("> Entrez votre numero telephone ");
            scanf("%lf",&phone1);

            fprintf(pT, "%s %s %s %.0lf %.0lf \n",fname1, lname1, gender1, sid1, phone1);
            printf("\n\nTraitement de  modifications....");

            flag = 1;
        }
        else
        {
            fprintf(pT, "%s %s %s %.0lf %.0lf \n",fname, lname, gender, sid, phone);
        }
    }

    fclose(pF);
    fclose(pT);

    fflush(stdin);

    pF = fopen("user_Records.txt", "w");
    fclose(pF);

    if(flag == 0)
    {
        printf("\n\n-------------------------------\n");
        printf(">>> Enregistrement introuvable<<<\n");
        printf("-------------------------------\n\n");
        printf("Redirection vers le panneau utilisateur...");
    }

    pF = fopen("user_Records.txt", "a");
    pT = fopen("temporary.txt", "r");

    while(fscanf(pT, "%s %s %s %lf %lf \n", fname, lname, gender, &sid, &phone) != EOF)
    {
        fprintf(pF, "%s %s %s %.0lf %.0lf \n", fname, lname, gender, sid, phone);
    }

    fclose(pF);
    fclose(pT);

    pT = fopen("temporary.txt", "w");
    fclose(pT);

    fflush(stdin);

    Sleep(2000);
    partieutilisateur();

}
